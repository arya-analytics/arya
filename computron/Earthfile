# computron/Earthfile
VERSION 0.7

# Base image with Go and Python
FROM golang:1.23

deps:
    # Install Python build dependencies
    RUN apt-get update && apt-get install -y \
        python3 \
        python3-pip \
        python3-dev \
        build-essential

build:
    FROM +deps
    WORKDIR /computron
    COPY . .
    RUN chmod +x build-linux.sh
    RUN ./build-linux.sh
    SAVE ARTIFACT /computron/* AS LOCAL .

source:
    FROM +build
    SAVE ARTIFACT /computron /computron